学习笔记

1、JVM的理解

JVM（java虚拟机）是实现JAVA语言作为跨平台语言的基石，它是个虚拟化的机器，通过它来运行通过编译器编译之后的字节码文件(即.class文件)。任何
装有jvm的不同操作系统平台都可以执行java文件。其中jvm中最重要的组成部分是包括堆在内的运行时数据区（由程序计数器，Java虚拟机栈，本地方法栈，
堆内存，方法区），堆外内存是不属于jvm管理的，即无法通过gc来进行内存的回收利用。堆内存是GC操作的内存区域，分为年轻代，老年代，持久代，所以
java代码里无需手动去回收释放堆内存，这块内存完全由gc去帮我们自动管理，当然即便有gc，如果堆内存使用不合理，同样会出现OOM的问题。

2、JAVA中的NIO的理解

即IO多路复用基于NIO来实现，IO多路复用是一种事件驱动模型，而IO多路复用则使用了Reactor的设计模式。所谓IO多路复用是指使用一个线程去管理多个
socket(多个socket需要注册到select上),通过轮询的方式(通过操作系统的select/poll/epoll机制来进行轮询)发现socket的读写事件时，启动IO
读写操作。Netty作为一个高性能的JAVA网络应用开发框架，底层是基于NIO实现，它的线程模型也是和Reactor的主从模式相似。

3、JAVA中的并发编程

并发跟并行的区别就是并发的多个线程之间是有相互协作的关系(各个线程运行的是一些相关的子任务)。并发的实现形式就是充分使用多核CPU去启动执行多线程，
以提高任务的执行效率。然后如何控制多个线程之间之间的协作可以通过Thread#join()、Object#wait()和notify()来实现。另外多线程模式下就会涉及
到线程安全的问题(即多个线程同时执行同一块代码逻辑，很容易造成结果的不一致问题)，一般可以通过Java中的锁来保证，Java中最基本的锁关键字是
synchronized和Lock，在此基础上JAVA还提供了一些开箱即用的原子类和并发工具类，如AtomicInteger,LongAdder,CountDownLatch等。

4、Spring和ORM等框架

ORM即对象关系映射，主要用在面向对象的编程语言中。JAVA中常用的ORM框架有Mybatis、JPA和Hibernate等。
Spring里主要2个特征就是IOC(控制反转)和AOP(面向切面)。
IOC是指将代码中用到的对象及对应的依赖对象的创建和销毁的生命周期交由spring容器去进行管理，当需要时由spring容器帮助我们自动注入。
AOP面向切面是指对某个类或者方法定义一个切面，然后使用JDK动态代理(接口类)或者CGLIB（非接口类）进行增强，其中需要增强的方法称为切入点。增强的实现方式
有前置增强、后置增强、环绕增强、异常增强等。具体的AOP操作一般基于注解方式实现，也可通过xml配置文件方式实现。

5、Mysql数据库

Mysql作为关系型数据库中使用率最广的数据库之一，它常用的执行引擎主要有InnoDB(4.0版本开始支持)和MyISAM。其中InnoDB引擎支持ACID事务机制，另外锁的粒度
由最初的表级锁(意向锁)细化到行级锁(锁的粒度降低，增大了并发性)，并且实现了SQL标准的四种隔离级别(Mysql默认的事务隔离级别为可重复读)。还有InnoDB里使用
B+树来实现了聚集索引，合理地给表字段设置索引可以提升表的查询性能。Mysql里使用undo log来保证事务的原子性，一般用来做事务回滚、崩溃恢复；使用redo log
来确保事务提交时的可靠性和写数据的性能。关于MVCC的实现机制是通过事务链表(存储当前所有还未提交的事务)来实现，这个MVCC机制还需要再研究下，比较复杂。
关于sql优化这一点，读操作时过滤条件里尽量使用索引字段来过滤；DDL操作的话尽量不要去操作范围，容易产生GAP锁的问题，最好去操作精确的行数据。
Mysql的读写分离模式，从库的数据就是通过binlog来定时向主库进行数据增量同步的。Mysql的高可用通过MGR进行实现。

6、分库分表

由于业务数据量的越来越大，单个主库容量(主从模式)已经无法正常支撑业务运行，读写性能劣化很严重，所以就需要进行分库分表。分库分表拆分方式分为水平拆分
和垂直拆分。库垂直拆分就是按照业务来拆分，拆分成多个提供不同业务数据处理能力的数据库，但是这种拆分方式很快就能到底，无法无限制地拆分下去，而且原来
的业务SQL也需要进行对应地修改。水平拆分就是仅仅对数据拆分，数据库和表结构不变。拆分粒度可以是数据库级别，也可以是表级别。水平拆分通常需要自定义
来指定数据路由规则，通常可以按照ID取模或者按照时间的方式来制定数据路由规则。只分表不分库不解决容量和磁盘IO瓶颈的性能问题。开源的分库分表框架有
Apache ShardingSphere-JDBC和TDDL。另外分库分表就带来分布式事务的问题，分布式事务分为XA强一致性事务和柔性事务。柔性事务可以在业务侧补偿冲正
来实现解决，也可以通过开源的分布式事务框架来保证解决(如himly和seata)。

7、RPC和微服务

RPC全称叫远程过程调用。RPC的调用链是客户端本地通过Socket通信的方式远程调用服务提供端的真正业务服务，然后服务端将调用结果按原路返回给客户端本地
调用方。JAVA里一般使用动态代理或者AOP来实现接口的远程服务调用。微服务架构的底层就是基于RPC发展起来的，使用在实际的分布式业务场景中。典型的微服务
架构里除了服务调用方和服务提供方之外，至少需要一个注册中心。目前常用的微服务框架有Apache Dubbo和Spring Cloud。Dubbo里使用zookeeper来
充当注册中心实现服务的自动注册和自动发现，另外dubbo内置了LoadBlance来供客户端调用远程服务时实现负载均衡。

8、分布式缓存

服务架构由最初的单体模式变成分布式多服务架构，于是本地的缓存已不适应用分布式微服务架构，如何保证多个JVM进程中的缓存数据保持同步一致性，就出现了
分布式缓存的概念。实际项目中一般使用redis中间件来实现分布式缓存，基于redis配合lua脚本可以保证redis操作的原子性，进而来实现分布式锁。


9、分布式消息队列

分布式消息队列作为系统间的通信方式之一，比其他通信方式(如socket,数据库，RPC方式)更适用在请求量并发量大的场景中，实现了异步地消息通信，同时保证
消息的可靠性。业界主流的MQ有ActiveMQ/RabbitMQ->rocketMQ/Kafka->Apache Pulsar。目前使用率最广的是Kafka，是一种分布式的，基于发布/订阅
模式的消息系统，即使在大数据量下也能达到高吞吐率。
